if (!require("pacman")) install.packages("pacman")
library(pacman)
pacman::p_load(
tidyverse,
openxlsx,
metafor
)
data.violence <- read.xlsx("data.meta.all.xlsx")
data.violence <- arrange(data.violence, desc(data.violence$tool))
shapes = c(15, 17, 9)
shapes <- shapes[as.numeric(data.violence$group)]
colours = c("gray28", "gray28", "deepskyblue4")
colours <- colours[as.numeric(data.violence$group)]
forest(x = data.violence$auc, ci.lb = data.violence$auc.lower, ci.ub = data.violence$auc.upper,
slab = data.violence$`author(s).and.year`,
psize = rep(1, length(data.violence$auc)),
xlab = "area under the curve (AUC)", refline = 0.5,
ylim = c(-0.5, 56), xlim = c(-0.2, 1.15),
ilab = c(data.violence$samplesize), ilab.xpos = 0.2,
at = c(0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 1),
rows = c(0:3, 8:11, 14:17, 22:26, 29:33, 36:45, 48:51),
cex = 1.15, header = "Author(s) and Year",
pch = shapes, col = colours)
# add text to header ####
op <- par(cex=1.15, font=2)
text(0.2, 55, "Sample size")
text(0.965, 55.1, "AUC")
par(op)
op <- par(cex=1.15, font=4)
text(-0.2, c(4, 12, 18, 27, 34, 46, 52), pos = 4,
c("Static99", "PCL:SV", "HCR20v2", "VRAG", "Static99", "HCR20v2", "H10"))
par(op)
op <- par(cex=1.2, font=2)
text(-0.2, c(5, 19, 53), pos = 4,
c("Sexual Recidivism", "General recidivism", "Violent recidivism"))
dev.off()
## add notes ####
par(op)
op <- par(cex=1.0, font=2)
text(-.3, -0.5, pos = 4, cex = 1.0, paste("Note"))
shapes = c(15, 17, 9)
shapes <- shapes[as.numeric(data.violence$group)]
colours = c("gray28", "gray28", "deepskyblue4")
colours <- colours[as.numeric(data.violence$group)]
forest(x = data.violence$auc, ci.lb = data.violence$auc.lower, ci.ub = data.violence$auc.upper,
slab = data.violence$`author(s).and.year`,
psize = rep(1, length(data.violence$auc)),
xlab = "area under the curve (AUC)", refline = 0.5,
ylim = c(-0.5, 56), xlim = c(-0.2, 1.15),
ilab = c(data.violence$samplesize), ilab.xpos = 0.2,
at = c(0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 1),
rows = c(0:3, 8:11, 14:17, 22:26, 29:33, 36:45, 48:51),
cex = 1.15, header = "Author(s) and Year",
pch = shapes, col = colours)
# add text to header ####
op <- par(cex=1.15, font=2)
text(0.2, 55, "Sample size")
text(0.965, 55.1, "AUC")
par(op)
op <- par(cex=1.15, font=4)
text(-0.2, c(4, 12, 18, 27, 34, 46, 52), pos = 4,
c("Static99", "PCL:SV", "HCR20v2", "VRAG", "Static99", "HCR20v2", "H10"))
par(op)
op <- par(cex=1.2, font=2)
text(-0.2, c(5, 19, 53), pos = 4,
c("Sexual Recidivism", "General recidivism", "Violent recidivism"))
## add notes ####
par(op)
op <- par(cex=1.0, font=2)
text(-.3, -0.5, pos = 4, cex = 1.0, paste("Note"))
par(op)
op <- par(cex=1.0, font=3)
text(-.3, -1.5, pos = 4, cex = .75, paste("Gray et al (2007)* includes the non-ID sample"))
# data for the geographical map
world.data <- read.xlsx("worldcount.xlsx")
world_map <- map_data("world")
install.packages("venneuler")
install.packages("rJava")
install.packages("venneuler")
library(rJava)
library(venneuler)
vd <- venneuler(c(A = 3,
B = 3,
C = 47,
"A&B" = 2,
"A&C" = 1,
"B&C" = 1,
"A&B&C" = 1))
library(venneuler)
library(rJava)
install.packages("rJava")
library(rJava)
library("ggplot2")
library(ggVennDiagram)
x <- list(A = c(1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47),
B = c(47, 48, 55), c = c(47, 48, 49))
ggVennDiagram(x,
label_alpha = 0,
color = "gray28",
lwd = 0.8, lty = 1,
label = "count",
category.names = c("External validation",
"Internal validation",
"Development")) +
scale_fill_gradient(low = "lightcyan", high = "deepskyblue4") +
guides(fill = guide_legend(title = "Title")) +
theme(legend.title = element_text(color = "gray28"),
legend.position = "bottom")
## ggVennDiagram ####
ggVennDiagram(x)
install.packages("ggVennDiagram")
library(ggVennDiagram)
install.packages("ggplot2")
## ggVennDiagram ####
ggVennDiagram(x)
library(ggVennDiagram)
## ggVennDiagram ####
ggVennDiagram(x)
ggVennDiagram(x,
label_alpha = 0,
color = "gray28",
lwd = 0.8, lty = 1,
label = "count",
category.names = c("External validation",
"Internal validation",
"Development")) +
scale_fill_gradient(low = "lightcyan", high = "deepskyblue4") +
guides(fill = guide_legend(title = "Title")) +
theme(legend.title = element_text(color = "gray28"),
legend.position = "bottom")
ggVennDiagram(x, category.names = c("External validation",
"Internal validation",
"Development"))
ggVennDiagram(x, color = "black", lwd = 0.8, lty = 1) +
scale_fill_gradient(low = "#F4FAFE", high = "#4981BF")
ggVennDiagram(x,
label_size = 9,
set_size =10,
category.names = c("External", "Development", "Internal"))+
scale_fill_viridis_c() +
theme(legend.position = "none")
install.packages("ggvenn")
library(ggvenn)
ggvenn(x, fill_color = c("gray28", "deepskyblue4", "rosybrown1"))
ggvenn(x)
vd <- venneuler(c(A = 3,
B = 3,
C = 47,
"A&B" = 2,
"A&C" = 1,
"B&C" = 1,
"A&B&C" = 1))
library(venneuler)
if (!require("pacman")) install.packages("pacman")
library(pacman)
pacman::p_load(
tidyverse,
openxlsx,
metafor,
maps
)
# data for the meta-analysis
data.violence <- read.xlsx("data.meta.all.xlsx")
data.violence <- arrange(data.violence, desc(data.violence$tool))
# data for the geographical map
world.data <- read.xlsx("worldcount.xlsx")
# violent recividivsm
data1 <- read.xlsx("data.violence1.xlsx")
data2 <- read.xlsx("data.violence2.xlsx")
# general recividivsm
data.general <- read.xlsx("data.general.xlsx")
# sexual recidivism
data.sexual<- read.xlsx("data.sexual.xlsx")
data.sexual <- arrange(data.sexual, desc(data.sexual$tool))
shapes = c(15, 17)
shapes <- shapes[as.numeric(data.sexual$group)]
forest(x = data.sexual$auc, ci.lb = data.sexual$auc.lower, ci.ub = data.sexual$auc.upper,
slab = data.sexual$`author(s).and.year`,
psize = rep(1, length(data.sexual$auc)),
xlab = "area under the curve (AUC)", refline = 0.5,
ylim = c(2, 66), xlim = c(-.5, 1.2),
ilab = c(data.sexual$samplesize), ilab.xpos = 0.1,
at = c(0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 1),
rows = c(3, 6, 9:11, 14, 17:22, 25, 28, 31:32, 35, 38:39, 42:44, 47, 50, 53:55, 58, 61),
cex = 1.0, header = "Author(s) and Year",
pch = shapes)
op <- par(cex=1.0, font=2)
text(0.1, 65, "Sample size")
text(0.87, 65.1, "AUC")
par(op)
op <- par(cex=1.0, font=2)
text(-.5, c(4, 7, 12, 15, 23, 26, 29, 33, 36, 40, 45, 48, 51, 56, 59, 62), pos = 4,
c("VRS-SO", "VRAG", "SVR-20", "Static 99R", "Static 99", "Static 2002R", "Static 2002", "SORAG", "SAPROF", "SACJ-Min", "RRASOR", "Risk Matrix 2000", "PPI", "PCL-R", "HCR20v2", "BARR 2002R"))
shapes = c(15, 17)
shapes <- shapes[as.numeric(data1$group)]
forest(x = data.general$auc, ci.lb = data.general$auc.lower, ci.ub = data.general$auc.upper,
slab = data.general$`author(s).and.year`,
psize = rep(1, length(data.general$auc)),
xlab = "area under the curve (AUC)", refline = 0.5,
ylim = c(0.5, 113), xlim = c(-0.8, 1.25),
ilab = c(data.general$samplesize), ilab.xpos = -0.2,
at = c(0.0, 0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 1),
rows = c(0, 3, 6:7, 10, 13, 16, 19:20, 23:25, 28:30, 33:34, 37, 40:41, 44, 47, 50:57, 60:63, 66, 69, 72, 75, 78, 81, 84, 87:89, 92:96, 99:100, 103, 106, 109),
pch = shapes)
